<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bong.repository.mappers.StbMapper">

    <select id="getStbInfo" parameterType="com.bong.domain.request.StbInfoSearchParam" resultType="com.bong.domain.response.Stb">
      	SELECT   TRIM(A.IPTV_STATUS_CODE) AS IPTV_STATUS_CODE
			,A.USER_INIT_NUM
			,A.ID_PACKAGE
			,A.TV_PACKAGE
			,A.NETWORK_TYPE
			,A.IPTV_USABLE
			,DECODE(C.POST_NO, NULL, '137072', C.POST_NO) AS POST_NO
			,B.MODEL_CODE
			,A.SERVICE_CODE
		 FROM	STB A, PHYSICAL_STB B, STB_LOCATION C
	    WHERE	A.STB_ID = B.STB_ID
		  AND	A.USER_SERVICE_NUM = C.USER_SERVICE_NUM(+)
		  AND	A.STB_ID = #{stb_id}
		  AND	B.MAC_ADDRESS = #{mac_address}
		  AND	ROWNUM = 1
    </select>
</mapper>
